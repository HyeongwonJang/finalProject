<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- MyBatis에서 namespace는 필수적으로 명시해야 함 -->
 <mapper namespace="petOwner">
 	<resultMap type="povo" id="povoRM">
 		<id column="Pet_Owner_no" property="petOwnerNo"/>
 		<id column="Pet_Owner_tel" property="petOwnerTel"/>
 		<id column="Pet_Owner_name" property="petOwnerName"/>
 		<id column="Pet_Owner_id" property="petOwnerId"/>
 		<id column="Pet_Owner_password" property="petOwnerPassword"/>
 		<id column="Pet_Owner_address" property="petOwnerAddress"/>
 		<collection property="petVO" ofType="pvo">
 			<id column="Pet_name" property="petName"/>
 			<id column="Pet_birthday" property="petBirthday"/>
 			<id column="Pet_gender" property="petGender"/>
 			<id column="Pet_note" property="petNote"/>
 			<id column="Animal_kind_name" property="animalKindName"/>
 		</collection>
 	</resultMap>
 	<select id="loginPetOwner" resultType="povo" resultMap="povoRM">
 		select po.Pet_Owner_no, po.Pet_Owner_id, po.Pet_Owner_name, po.Pet_Owner_tel, po.Pet_Owner_address
		from  Pet_Owner po, Pet p
		where po.Pet_Owner_id = #{petOwnerId} and po.Pet_Owner_password =#{petOwnerPassword} 
			and po.Pet_Owner_no = p.Pet_Owner_no			
 	</select>
 	<select id="findMemberPetOwnerByTel" parameterType="povo" resultType="povo" resultMap="povoRM">
 		select po.Pet_Owner_tel, po.Pet_Owner_name, mpo.Pet_Owner_id, mpo.Pet_Owner_address
		from Pet_Owner po, Member_Pet_Owner mpo
		where po.Pet_Owner_tel = mpo.Pet_Owner_tel and po.Pet_Owner_tel = #{petOwnerTel} 	
 	</select>
 	<select id="findPetByTel" parameterType="povo" resultType="povo" resultMap="povoRM">
 		select po.Pet_Owner_tel, po.Pet_Owner_name, mpo.Pet_Owner_id, mpo.Pet_Owner_address, p.Pet_name
		from Pet_Owner po, Member_Pet_Owner mpo, Pet p
		where po.Pet_Owner_tel = mpo.Pet_Owner_tel and po.Pet_Owner_tel = p.Pet_Owner_tel and po.Pet_Owner_tel = #{petOwnerTel} 	
 	</select>
 	<insert id="registerPetOwner" parameterType="povo">
 		insert into Pet_Owner(Pet_Owner_tel, Pet_Owner_name)
		values(#{petOwnerVO.petOwnerTel}, #{petOwnerVO.petOwnerName})
 	</insert>
 	<insert id="registerMemberPetOwner" parameterType="povo">
		insert into Member_Pet_Owner(Pet_Owner_tel, Pet_Owner_id, Pet_Owner_password, Pet_Owner_address)
		values(#{petOwnerVO.petOwnerTel}, #{petOwnerId}, #{petOwnerPassword}, #{petOwnerAddress})
 	</insert>
 	
 	<insert id="registerPet" parameterType="pvo">
		insert into Pet(Pet_name, Pet_Owner_tel, Pet_birthday, Pet_gender, Pet_note, Animal_kind_name)
		values(#{petName}, '01012341234', #{birthday}, #{gender}, #{note}, #{animalKindName}) 	
 	</insert>
 	
 	<update id="updatePetOwner" parameterType="povo">
 		update Pet_Owner
		set Pet_Owner_tel=#{petOwnerTel}, Pet_Owner_name=#{petOwnerName},
			 Pet_Owner_password=#{petOwnerPassword}, Pet_Owner_address = #{petOwnerAddress}
		where Pet_Owner_id = #{petOwnerId}  
 	</update>
 	
 	<update id ="deletePetOwner" parameterType="povo">
 		update Pet_Owner
		set Pet_Owner_id=null, Pet_Owner_password=null, Pet_Owner_address=null
		where Pet_Owner_id = #{petOwnerId}
 	</update>
 	
 	
 	
 </mapper>